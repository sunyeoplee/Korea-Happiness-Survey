library(readxl)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(readr)
library(skimr)
library(MASS)
library(sjlabelled)
library(gtools)
library(tableone)
library(survey)
library(gmodels)
# import data
data <- read_excel("C:/Users/USER/Desktop/Backup/Gap year/Korea Happiness Survey/data/raw_data.xlsx")
covid_data <- read_excel("C:\\Users\\USER\\Desktop\\Backup\\Gap year\\Korea Happiness Survey\\data\\COVID-KR.xlsx")
covid_data <- covid_data[c(1:17),]
mydata <- data %>%
dplyr::rename( id=ID, census=???豸?ڵ?, area=LOC, # levels
smokingchange=CO20, alcoholchange=CO21,# outcomes
socialladder=C1, basicincome=SQ109, # SES measures
chronicdisease=DQ13, # health measures
happiness=A1, life_satisfaction=A302,# psychological wellbeing measures
age=AGE, sex1=SQ903,
a=CO22# covariates
) # %>%
mydata <- data %>%
dplyr::rename( id=ID, census=집계구코드, area=LOC, # levels
smokingchange=CO20, alcoholchange=CO21,# outcomes
socialladder=C1, basicincome=SQ109, # SES measures
chronicdisease=DQ13, # health measures
happiness=A1, life_satisfaction=A302,# psychological wellbeing measures
age=AGE, sex1=SQ903,
a=CO22# covariates
) # %>%
summary(factor(mydata$a))
levels(factor(mydata$sex1))
class(mydata$sex1)
summary(factor(mydata$population))
dim(mydata)
head(covid_data)
# add covid data to the survey data
mydata$covid_cases <- NA
mydata$population <- NA
for (i in 1:17) {
mydata$covid_cases[mydata$area==i] <- as.numeric(covid_data$cumulative_cases[covid_data$LOC==i])
mydata$population[mydata$area==i] <- round(as.numeric(covid_data$population[covid_data$LOC==i]))
}
### modify variables ###
# levels
mydata$area <- factor(mydata$area)
mydata$smokingchange <- factor(mydata$smokingchange, levels = c("3", "2", "1"))
mydata$smoking_increased <- recode_factor(factor(mydata$smokingchange),'1'='yes',
'2'='no', '3'="no")
mydata$smoking_increased <- factor(mydata$smoking_increased, levels = c("no", "yes"))
mydata$alcohol_increased <- recode_factor(factor(mydata$alcoholchange),'1'='yes',
'2'='no', '3'="no",
'4'='NA')
mydata$alcohol_increased <- factor(mydata$alcohol_increased, levels = c("no", "yes"))
mydata$basicincome_binary <- recode_factor(factor(mydata$basicincome),'1'='yes', '2'='yes',
'3'="no")
mydata$basicincome_binary <- factor(mydata$basicincome_binary, levels = c("no", "yes"))
CrossTable(mydata$alcohol_increased)
chisq.test(mydata$smoking_increased, mydata$basicincome)
summary(factor(mydata$smokingchange))
CrossTable(mydata$alcohol_increased)
summary(mydata$sex)
summary(mydata$sex1)
summary(factor(mydata$sex1))
summary(factor(mydata$area))
a = na.omit(mydata)
dplyr::select(c(sex1))
mydata <- data %>%
dplyr::rename( id=ID, census=집계구코드, area=LOC, # levels
smokingchange=CO20, alcoholchange=CO21,# outcomes
socialladder=C1, basicincome=SQ109, # SES measures
chronicdisease=DQ13, # health measures
happiness=A1, life_satisfaction=A302,# psychological wellbeing measures
age=AGE, sex1=SQ903,
a=CO22# covariates
) %>%
dplyr::select(c(sex1))
a = na.omit(mydata)
View(a)
mydata <- data %>%
dplyr::rename( id=ID, census=집계구코드, area=LOC, # levels
smokingchange=CO20, alcoholchange=CO21,# outcomes
socialladder=C1, basicincome=SQ109, # SES measures
chronicdisease=DQ13, # health measures
happiness=A1, life_satisfaction=A302,# psychological wellbeing measures
age=AGE, sex1=SQ903,
a=CO22# covariates
) %>%
dplyr::select(c(area,
sex1))
a = na.omit(mydata)
summary(factor(mydata$smokingchange))
mydata <- data %>%
dplyr::rename( id=ID, census=집계구코드, area=LOC, # levels
smokingchange=CO20, alcoholchange=CO21,# outcomes
socialladder=C1, basicincome=SQ109, # SES measures
chronicdisease=DQ13, # health measures
happiness=A1, life_satisfaction=A302,# psychological wellbeing measures
age=AGE, sex1=SQ903,
a=CO22# covariates
) # %>%
summary(factor(mydata$smokingchange))
142 + 371 + 11645
142 + 371 + 11645 + 1666
summary(factor(mydata$sex1))
# import data
data <- read_excel("C:/Users/USER/Desktop/Backup/Gap year/Korea Happiness Survey/data/raw_data.xlsx")
covid_data <- read_excel("C:\\Users\\USER\\Desktop\\Backup\\Gap year\\Korea Happiness Survey\\data\\COVID-KR.xlsx")
covid_data <- covid_data[c(1:17),]
mydata <- data %>%
dplyr::rename( id=ID, census=집계구코드, area=LOC, # levels
smokingchange=CO20, alcoholchange=CO21,# outcomes
socialladder=C1, basicincome=SQ109, # SES measures
chronicdisease=DQ13, # health measures
happiness=A1, life_satisfaction=A302,# psychological wellbeing measures
age=AGE, sex1=SQ903,
a=CO22# covariates
) # %>%
# dplyr::select(c(area,
#                 sex1))
summary(factor(mydata$smokingchange))
# dependent variables
mydata$smokingchange <- factor(mydata$smokingchange, levels = c("3", "2", "1"))
summary(factor(mydata$alcoholchange))
mydata$smokingchange <- factor(mydata$smokingchange, levels = c("3", "2", "1"))
mydata$smoking_increased <- recode_factor(factor(mydata$smokingchange),'1'='yes',
'2'='no', '3'="no")
mydata$smoking_increased <- factor(mydata$smoking_increased, levels = c("no", "yes"))
mydata$alcohol_increased <- recode_factor(factor(mydata$alcoholchange),'1'='yes',
'2'='no', '3'="no",
'4'='NA')
mydata$alcohol_increased <- factor(mydata$alcohol_increased, levels = c("no", "yes"))
level_var <- c("id", "census", 'area')
mydata[,level_var] <- lapply(mydata[,level_var], as.factor)
summary(factor(mydata$alcoholchange))
mydata$alcoholchange[mydata$alcoholchange == 4] <- NA
summary(factor(mydata$alcoholchange))
mydata$alcoholchange <- factor(mydata$alcoholchange, levels = c("3", "2", "1"))
mydata <- data %>%
dplyr::rename( id=ID, census=집계구코드, area=LOC, # levels
smoking_change=CO20, alcohol_change=CO21,# outcomes
socialladder=C1,  home_payment=SQ107, residence_type=SQ108, # sociodemographic measures
edu=DQ101, edu_paternal=DQ10101, edu_maternal=DQ10102,
grad=DQ102, grad_paternal=DQ10201, grad_maternal=DQ10202,
employed=DQ2, job_type=DQ3, employment_type1=DQ6, employment_type2=DQ7, work_hour=,
income_individual=DQ10, income_household=DQ1001, cost_of_living=DQ11, basicincome=SQ109,
marital_status=SQ906, age=AGE, sex=SQ903,
happiness=A1, life_satisfaction=A302, # psychological wellbeing measures
anxiety=CO23, worry=CO2301, depression=CO2302, apathy=CO2303, loneliness=CO2304,
physical_health=DQ12, chronic_disease=DQ13, disability=DQ14, # health measures
) # %>%
# import data
data <- read_excel("C:/Users/USER/Desktop/Backup/Gap year/Korea Happiness Survey/data/raw_data.xlsx")
covid_data <- read_excel("C:\\Users\\USER\\Desktop\\Backup\\Gap year\\Korea Happiness Survey\\data\\COVID-KR.xlsx")
covid_data <- covid_data[c(1:17),]
mydata <- data %>%
dplyr::rename( id=ID, census=집계구코드, area=LOC, # levels
smoking_change=CO20, alcohol_change=CO21,# outcomes
socialladder=C1,  home_payment=SQ107, residence_type=SQ108, # sociodemographic measures
edu=DQ101, edu_paternal=DQ10101, edu_maternal=DQ10102,
grad=DQ102, grad_paternal=DQ10201, grad_maternal=DQ10202,
employed=DQ2, job_type=DQ3, employment_type1=DQ6, employment_type2=DQ7, work_hour=,
income_individual=DQ10, income_household=DQ1001, cost_of_living=DQ11, basicincome=SQ109,
marital_status=SQ906, age=AGE, sex=SQ903,
happiness=A1, life_satisfaction=A302, # psychological wellbeing measures
anxiety=CO23, worry=CO2301, depression=CO2302, apathy=CO2303, loneliness=CO2304,
physical_health=DQ12, chronic_disease=DQ13, disability=DQ14 # health measures
) # %>%
# dplyr::select(c(area,
#                 sex1))
summary(factor(mydata$smoking_change))
# import data
data <- read_excel("C:/Users/USER/Desktop/Backup/Gap year/Korea Happiness Survey/data/raw_data_v2.xlsx")
mydata <- data %>%
dplyr::rename( id=ID, census=집계구코드, area=LOC, # levels
smoking_change=CO20, alcohol_change=CO21,# outcomes
socialladder=C1,  home_payment=SQ107, residence_type=SQ108, # sociodemographic measures
edu=DQ101, edu_paternal=DQ10101, edu_maternal=DQ10102,
grad=DQ102, grad_paternal=DQ10201, grad_maternal=DQ10202,
employed=DQ2, job_type=DQ3, employment_type1=DQ6, employment_type2=DQ7, work_hour=,
income_individual=DQ10, income_household=DQ1001, cost_of_living=DQ11, basicincome=SQ109,
marital_status=SQ906, age=AGE, sex=SQ903,
happiness=A1, life_satisfaction=A302, # psychological wellbeing measures
anxiety=CO23, worry=CO2301, depression=CO2302, apathy=CO2303, loneliness=CO2304,
physical_health=DQ12, chronic_disease=DQ13, disability=DQ14 # health measures
) # %>%
summary(factor(mydata$smoking_change))
summary(factor(mydata$sex))
View(data)
summary(factor(mydata$F_WT))
colnames(data)
summary(factor(mydata$읍면동동))
summary(factor(mydata$읍면동))
mydata <- data %>%
dplyr::rename( id=ID, census=집계구코드, area1=읍면동, area2=LOC, # levels
smoking_change=CO20, alcohol_change=CO21,# outcomes
socialladder=C1,  home_payment=SQ107, residence_type=SQ108, # sociodemographic measures
edu=DQ101, edu_paternal=DQ10101, edu_maternal=DQ10102,
grad=DQ102, grad_paternal=DQ10201, grad_maternal=DQ10202,
employed=DQ2, job_type=DQ3, employment_type1=DQ6, employment_type2=DQ7, work_hour=,
income_individual=DQ10, income_household=DQ1001, cost_of_living=DQ11, basicincome=SQ109,
marital_status=SQ906, age=AGE, sex=SQ903,
happiness=A1, life_satisfaction=A302, # psychological wellbeing measures
anxiety=CO23, worry=CO2301, depression=CO2302, apathy=CO2303, loneliness=CO2304,
physical_health=DQ12, chronic_disease=DQ13, disability=DQ14 # health measures
) # %>%
colnames(data)
mydata <- data %>%
dplyr::rename( id=ID, census=집계구코드, area1=읍면동, area2=시군구, area3=LOC, # levels
smoking_change=CO20, alcohol_change=CO21,# outcomes
socialladder=C1,  home_payment=SQ107, residence_type=SQ108, # sociodemographic measures
edu=DQ101, edu_paternal=DQ10101, edu_maternal=DQ10102,
grad=DQ102, grad_paternal=DQ10201, grad_maternal=DQ10202,
employed=DQ2, job_type=DQ3, employment_type1=DQ6, employment_type2=DQ7, work_hour=,
income_individual=DQ10, income_household=DQ1001, cost_of_living=DQ11, basicincome=SQ109,
marital_status=SQ906, age=AGE, sex=SQ903,
happiness=A1, life_satisfaction=A302, # psychological wellbeing measures
anxiety=CO23, worry=CO2301, depression=CO2302, apathy=CO2303, loneliness=CO2304,
physical_health=DQ12, chronic_disease=DQ13, disability=DQ14 # health measures
) # %>%
summary(factor(mydata$area1))
summary(factor(mydata$area2))
levels(factor(mydata$sex1))
levels(factor(mydata$sex))
lnegth(levels(factor(mydata$sex)))
length(levels(factor(mydata$sex)))
length(levels(factor(mydata$area1)))
length(levels(factor(mydata$area2)))
length(levels(factor(mydata$area3)))
summary(factor(mydata$census))
length(levels(factor(mydata$census)))
sum(is.na(mydata$census))
sum(is.na(mydata$area1))
sum(is.na(mydata$area2))
sum(is.na(mydata$area3))
levels(factor(mydata$sex))
mydata$a <- ifelse(mydata$sex == 1, 1, 0)
mydata$a <- mydata$a * mydata$F_WT
sum(mydata$a)
mydata <- data %>%
dplyr::rename( id=ID, census=집계구코드, area2=읍면동, area3=시군구, area=LOC, # levels
smoking_change=CO20, alcohol_change=CO21,# outcomes
socialladder=C1,  home_payment=SQ107, residence_type=SQ108, # sociodemographic measures
edu=DQ101, edu_paternal=DQ10101, edu_maternal=DQ10102,
grad=DQ102, grad_paternal=DQ10201, grad_maternal=DQ10202,
employed=DQ2, job_type=DQ3, employment_type1=DQ6, employment_type2=DQ7, work_hour=,
income_individual=DQ10, income_household=DQ1001, cost_of_living=DQ11, basicincome=SQ109,
marital_status=SQ906, age=AGE, sex=SQ903,
happiness=A1, life_satisfaction=A302, # psychological wellbeing measures
anxiety=CO23, worry=CO2301, depression=CO2302, apathy=CO2303, loneliness=CO2304,
physical_health=DQ12, chronic_disease=DQ13, disability=DQ14 # health measures
) # %>%
summary(factor(mydata$smoking_change))
summary(factor(mydata$alcohol_change))
